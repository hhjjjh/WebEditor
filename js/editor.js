'use strict';var _createClass=function(){function t(l,s){for(var u,m=0;m<s.length;m++)u=s[m],u.enumerable=u.enumerable||!1,u.configurable=!0,'value'in u&&(u.writable=!0),Object.defineProperty(l,u.key,u)}return function(l,s,m){return s&&t(l.prototype,s),m&&t(l,m),l}}();function _possibleConstructorReturn(t,l){if(!t)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return l&&('object'==typeof l||'function'==typeof l)?l:t}function _inherits(t,l){if('function'!=typeof l&&null!==l)throw new TypeError('Super expression must either be null or a function, not '+typeof l);t.prototype=Object.create(l&&l.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(t,l):t.__proto__=l)}function _classCallCheck(t,l){if(!(t instanceof l))throw new TypeError('Cannot call a class as a function')}var Editor=function(){function t(l,s){_classCallCheck(this,t),this.id=l,this.loadDefaultConfig(),this.createEditor(),void 0!=s&&(this.config=s),this.rightClicks=[],this.comEnableCalls=[],this.loadCommandBtn(),this.loadFootBtn(),this.loadContextRightClick()}return _createClass(t,[{key:'createEditor',value:function createEditor(){this.editor=document.getElementById(this.id),this.editor.setAttribute('unselectable','on'),this.editor.className='editor',this.createToolbar(),this.createContext(),this.createSource(),this.createFoot(),this.createPlugins(),this.createShield()}},{key:'createToolbar',value:function createToolbar(){this.toolbar=document.createElement('div'),this.toolbar.setAttribute('unselectable','on'),this.toolbar.className='editorTool',this.editor.appendChild(this.toolbar)}},{key:'createContext',value:function createContext(){this.context=document.createElement('div'),this.context.id=this.id+'_context',this.contextId=this.context.id,this.context.contentEditable=!0,this.context.className='editorContext',this.context.innerHTML='\u200B',this.editor.appendChild(this.context)}},{key:'createSource',value:function createSource(){this.source=document.createElement('textarea'),this.source.id=this.id+'_source',this.sourceId=this.source.id,this.source.className='editorSource',this.source.style.display='none',this.source.style.resize='none',this.editor.appendChild(this.source)}},{key:'createFoot',value:function createFoot(){this.foot=document.createElement('div'),this.foot.setAttribute('unselectable','on'),this.foot.className='editorFoot',this.editor.appendChild(this.foot)}},{key:'createPlugins',value:function createPlugins(){this.plugins=document.createElement('div'),this.plugins.setAttribute('unselectable','on'),this.plugins.className='editorPluginsDiv',this.plugins.setAttribute('unselectable','on'),this.editor.appendChild(this.plugins)}},{key:'createShield',value:function createShield(){this.shield=document.createElement('div'),this.shield.setAttribute('unselectable','on'),this.shield.className='editorShield',this.shield.style.display='none',this.editor.appendChild(this.shield)}},{key:'loadDefaultConfig',value:function loadDefaultConfig(){this.config=[{name:'source',title:'HTML\u4EE3\u7801'},{name:'bold',title:'\u52A0\u7C97'},{name:'italic',title:'\u659C\u4F53'},{name:'underline',title:'\u4E0B\u5212\u7EBF'},{name:'strikeThrough',title:'\u5220\u9664\u7EBF'},{name:'superscript',title:'\u4E0A\u6807'},{name:'subscript',title:'\u4E0B\u6807'},{name:'fontsize',title:'\u5B57\u53F7',items:['1','2','3','4','5','6','7']},{name:'fontsizestyle',title:'\u50CF\u7D20\u5B57\u53F7',items:['8px','16px','24px','32px','64px']},{name:'fontname',title:'\u5B57\u4F53',items:['','monospace','\u6A19\u6977\u9AD4','\u5E7C\u5706']},{name:'align',title:'\u5BF9\u9F50',items:['\u94FA\u6EE1','\u5C45\u4E2D','\u9760\u5DE6','\u9760\u53F3']},{name:'forecolor',title:'\u6587\u5B57\u989C\u8272',items:[['#E53333','#E56600','#FF9900','#64451D','#DFC5A4','#FFE500'],['#009900','#006600','#99BB00','#B8D100','#60D978','#00D5FF'],['#337FE5','#003399','#4C33E5','#9933E5','#CC33E5','#EE33EE'],['#FFFFFF','#CCCCCC','#999999','#666666','#333333','#000000']]},{name:'backcolor',title:'\u6587\u5B57\u80CC\u666F\u989C\u8272',items:[['#E53333','#E56600','#FF9900','#64451D','#DFC5A4','#FFE500'],['#009900','#006600','#99BB00','#B8D100','#60D978','#00D5FF'],['#337FE5','#003399','#4C33E5','#9933E5','#CC33E5','#EE33EE'],['#FFFFFF','#CCCCCC','#999999','#666666','#333333','#000000']]},{name:'removeFormat',title:'\u6E05\u9664\u683C\u5F0F'},{name:'indent',title:'\u589E\u52A0\u7F29\u8FDB'},{name:'outdent',title:'\u51CF\u5C11\u7F29\u8FDB'},{name:'insertOrderedList',title:'\u6709\u5E8F\u5217\u8868'},{name:'insertUnorderedList',title:'\u65E0\u5E8F\u5217\u8868'},{name:'insertImage',title:'\u63D2\u5165\u56FE\u7247',items:[['\u56FE\u7247\u8BBE\u7F6E']]},{name:'insertAudio',title:'\u63D2\u5165\u97F3\u9891'},{name:'insertVideo',title:'\u63D2\u5165\u89C6\u9891'},{name:'insertAnchor',title:'\u951A\u70B9'},{name:'createLink',title:'\u8D85\u94FE\u63A5',items:[['\u8D85\u94FE\u63A5\u8BBE\u7F6E']]},{name:'unlink',title:'\u53D6\u6D88\u8D85\u94FE\u63A5'},{name:'insertHr',title:'\u63D2\u5165\u76F4\u7EBF'},{name:'table',title:'\u63D2\u5165\u8868\u683C',items:[['\u914D\u7F6E\u8868\u683C'],['\u524D\u9762\u52A0\u4E00\u884C','\u540E\u9762\u52A0\u4E00\u884C','\u5220\u9664\u884C'],['\u524D\u9762\u52A0\u4E00\u5217','\u540E\u9762\u52A0\u4E00\u5217','\u5220\u9664\u5217'],['\u5411\u4E0B\u5408\u5E76\u5355\u5143\u683C','\u5411\u53F3\u5408\u5E76\u5355\u5143\u683C','\u62C6\u5206\u5355\u5143\u683C'],['\u6DFB\u52A0\u5355\u5143\u683C','\u5220\u9664\u5355\u5143\u683C','\u8BBE\u7F6E\u9009\u4E2D\u7684\u5355\u5143\u683C\u80CC\u666F']]},{name:'insertHTML',title:'\u63D2\u5165HTML'},{name:'formatpagebreak',title:'\u63D2\u5165\u5206\u9875\u6807\u8BB0'},{name:'print',title:'\u6253\u5370'},{name:'fullscreen',title:'\u5168\u9891'},{name:'test',title:'\u6D4B\u8BD5'}]}},{key:'loadCommandBtn',value:function loadCommandBtn(){var l=this;Array.from(this.config).map(function(s){var m=new CommandBtn(l,s).button;'source'==s.name&&(m=new ShowSource(l,s).button,l.registerCommandBtn(s.name,m)),'italic'==s.name&&(m=new Italic(l,s).button,l.registerCommandBtn(s.name,m)),'bold'==s.name&&(m=new Bold(l,s).button,l.registerCommandBtn(s.name,m)),'underline'==s.name&&(m=new Underline(l,s).button,l.registerCommandBtn(s.name,m)),'strikeThrough'==s.name&&(m=new StrikeThrough(l,s).button,l.registerCommandBtn(s.name,m)),'superscript'==s.name&&(m=new Superscript(l,s).button,l.registerCommandBtn(s.name,m)),'subscript'==s.name&&(m=new Subscript(l,s).button,l.registerCommandBtn(s.name,m)),'fontsize'==s.name&&(m=new FontSize(l,s).button,l.registerCommandBtn(s.name,m)),'fontsizestyle'==s.name&&(m=new FontSizeStyle(l,s).button,l.registerCommandBtn(s.name,m)),'fontname'==s.name&&(m=new FontName(l,s).button,l.registerCommandBtn(s.name,m)),'align'==s.name&&(m=new Align(l,s).button,l.registerCommandBtn(s.name,m)),'forecolor'==s.name&&(m=new ForeColor(l,s).button,l.registerCommandBtn(s.name,m)),'backcolor'==s.name&&(m=new BackColor(l,s).button,l.registerCommandBtn(s.name,m)),'removeFormat'==s.name&&(m=new RemoveFormat(l,s).button,l.registerCommandBtn(s.name,m)),'indent'==s.name&&(m=new Indent(l,s).button,l.registerCommandBtn(s.name,m)),'outdent'==s.name&&(m=new Outdent(l,s).button,l.registerCommandBtn(s.name,m)),'insertOrderedList'==s.name&&(m=new InsertOrderedList(l,s).button,l.registerCommandBtn(s.name,m)),'insertUnorderedList'==s.name&&(m=new InsertUnorderedList(l,s).button,l.registerCommandBtn(s.name,m)),'insertImage'==s.name&&(m=new InsertImage(l,s).button,l.registerCommandBtn(s.name,m)),'insertAudio'==s.name&&(m=new InsertAudio(l,s).button,l.registerCommandBtn(s.name,m)),'insertVideo'==s.name&&(m=new InsertVideo(l,s).button,l.registerCommandBtn(s.name,m)),'insertAnchor'==s.name&&(m=new InsertAnchor(l,s).button,l.registerCommandBtn(s.name,m)),'createLink'==s.name&&(m=new CreateLink(l,s).button,l.registerCommandBtn(s.name,m)),'unlink'==s.name&&(m=new Unlink(l,s).button,l.registerCommandBtn(s.name,m)),'insertHr'==s.name&&(m=new InsertHr(l,s).button,l.registerCommandBtn(s.name,m)),'table'==s.name&&(m=new Table(l,s).button,l.registerCommandBtn(s.name,m)),'insertHTML'==s.name&&(m=new InsertHTML(l,s).button,l.registerCommandBtn(s.name,m)),'formatpagebreak'==s.name&&(m=new Formatpagebreak(l,s).button,l.registerCommandBtn(s.name,m)),'print'==s.name&&(m=new Print(l,s).button,l.registerCommandBtn(s.name,m)),'fullscreen'==s.name&&(m=new Fullscreen(l,s).button,l.registerCommandBtn(s.name,m)),'test'==s.name&&(m=new Test(l,s).button,l.registerCommandBtn(s.name,m))})}},{key:'loadFootBtn',value:function loadFootBtn(){var l=document.createElement('button');l.innerText='\u63D0\u4EA4',this.registerFootBtn(l)}},{key:'loadContextRightClick',value:function loadContextRightClick(){var l=this;this.context.onmouseup=function(s){2===s.button&&Array.from(l.rightClicks).map(function(m){m()})},this.context.onclick=function(){Array.from(l.plugins.childNodes).map(function(s){s.style.display='none'}),l.commandBtnIsOpen()},this.context.onkeyup=function(){l.commandBtnIsOpen()}}},{key:'commandBtnIsOpen',value:function commandBtnIsOpen(){var l=this;Array.from(l.comEnableCalls).map(function(s){s()})}},{key:'getContext',value:function getContext(){var l=this,s=void 0;return Array.from(this.toolbar.children).map(function(m){'source'==m.className?s=l.context.innerHTML:'source_open'==m.className&&(s=l.source.value)}),s}},{key:'setContext',value:function setContext(l){var s=this;Array.from(this.toolbar.children).map(function(m){'source'==m.className?s.context.innerHTML=l:'source_open'==m.className&&(s.source.value=l)})}},{key:'registerCommandBtn',value:function registerCommandBtn(l,s){var m=this;Array.from(this.config).map(function(u){u.name==l&&(m.toolbar.appendChild(s),m.context.style.top=m.toolbar.offsetHeight,m.source.style.top=m.toolbar.offsetHeight)})}},{key:'registerContextRightClick',value:function registerContextRightClick(l){this.rightClicks.push(l)}},{key:'registerFootBtn',value:function registerFootBtn(l){this.foot.appendChild(l),this.context.style.bottom=this.foot.offsetHeight,this.source.style.bottom=this.foot.offsetHeight}},{key:'registerEnableCall',value:function registerEnableCall(l){this.comEnableCalls.push(l)}}]),t}(),CommandBtn=function(){function t(l,s){_classCallCheck(this,t),this.editor=l,this.config=s,this.createCommandBtn()}return _createClass(t,[{key:'createCommandBtn',value:function createCommandBtn(){var l=document.createElement('button');l.setAttribute('unselectable','on'),l.className=this.config.name,l.title=this.config.title;var s=this;l.onclick=function(u){s.click(u,s.button)},this.button=l;this.editor.registerEnableCall(function enableCall(){s.isEnableCall()})}},{key:'isEnableCall',value:function isEnableCall(){}},{key:'click',value:function click(l,s){alert('\u60A8\u70B9\u51FB\u4E86\u6309\u94AE\uFF1A'+s.className)}}]),t}(),Select=function(){function t(l,s,m){_classCallCheck(this,t),this.editor=l,this.items=s,this.button=m,this.loadItem()}return _createClass(t,[{key:'loadItem',value:function loadItem(){var l=this;this.select=document.createElement('div'),this.select.setAttribute('unselectable','on'),this.select.className='select',this.select.id=this.select.className+'_'+this.button.className,this.select.style.display='none',null!=this.items&&Array.from(this.items).map(function(s){var m=document.createElement('div');m.setAttribute('unselectable','on');var u=document.createElement('button');u.className='selectitem',u.setAttribute('unselectable','on'),u.innerText=s,l.configItemNode(u,s);var p=l;u.onclick=function(){p.select.style.display='none',Array.from(p.select.childNodes).map(function(y){y.className='selectitem'}),m.className='selectitemOn',p.click(s)},m.appendChild(u),l.select.appendChild(m)}),this.editor.plugins.appendChild(this.select)}},{key:'btnClick',value:function btnClick(l,s){var m=this;Array.from(this.editor.plugins.childNodes).map(function(u){u.id!=m.select.id&&(u.style.display='none')}),'block'==this.select.style.display?this.select.style.display='none':(this.select.style.display='block',this.select.style.left=s.offsetLeft,this.select.style.top=s.offsetTop+s.offsetHeight)}},{key:'configItemNode',value:function configItemNode(){}},{key:'click',value:function click(){alert('\u9009\u9879\u547D\u4EE4\u4E8B\u4EF6\uFF0C\u7531\u5B50\u7C7B\u5B9E\u73B0')}}]),t}(),GroupSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){var s=this;this.select=document.createElement('div'),this.select.setAttribute('unselectable','on'),this.select.className='groupselect',this.select.id=this.select.className+'_'+this.button.className,this.select.style.display='none',null!=this.items&&Array.from(this.items).map(function(m){var u=m.length,f=document.createElement('div');f.setAttribute('unselectable','on'),s.configGroupNode(f,m),Array.from(m).map(function(y){var b=document.createElement('button');b.setAttribute('unselectable','on'),b.className='groupselectitem',b.title=y,s.configItemNode(b,y);var C=s;b.onclick=function(){C.select.style.display='none',Array.from(C.select.childNodes).map(function(_){Array.from(_.childNodes).map(function(N){N.className='groupselectitem'})}),b.className='groupselectitemOn',C.click(y)},f.appendChild(b)}),s.select.appendChild(f)}),this.editor.plugins.appendChild(this.select)}},{key:'configGroupNode',value:function configGroupNode(){}}]),l}(Select),RightMenu=function(t){function l(s,m,u,p){_classCallCheck(this,l);var f=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m,u));return f.tag=p,f.contextRightClick(),f}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){var s=this;this.select=document.createElement('div'),this.select.setAttribute('unselectable','on'),this.select.className='rightmenu',this.select.id=this.select.className+'_'+this.button.className,this.select.style.display='none',null!=this.items&&Array.from(this.items).map(function(m){var u=m.length,f=document.createElement('div');f.setAttribute('unselectable','on'),s.configGroupNode(f,m),Array.from(m).map(function(y){var b=document.createElement('div');b.setAttribute('unselectable','on');var C=document.createElement('button');C.setAttribute('unselectable','on'),C.className='rightmenuitem',C.innerText=y,s.configItemNode(C,y);var k=s;C.onclick=function(){k.select.style.display='none',k.click(y)},b.appendChild(C),f.appendChild(b)}),s.select.appendChild(f)}),this.editor.plugins.appendChild(this.select)}},{key:'rightClick',value:function rightClick(){for(var s=this,m=this.editor.context.getElementsByTagName(this.tag),u=function _loop(p){m[p].oncontextmenu=function(f){return s.select.style.display='block',s.select.style.left=f.clientX-s.editor.editor.offsetLeft,s.select.style.top=f.clientY-s.editor.editor.offsetTop,s.tag=m[p],!1}},p=0;p<m.length;p++)u(p)}},{key:'contextRightClick',value:function contextRightClick(){var s=this;this.editor.registerContextRightClick(function rightClick(){s.rightClick()})}}]),l}(GroupSelect),BasicWindow=function(){function t(l,s,m){_classCallCheck(this,t),this.editor=l,this.id=s,this.title=m,this.labWidth='80px',this.formItemWidth='200px',this.createWindow()}return _createClass(t,[{key:'createWindow',value:function createWindow(){this.basicWindow=document.createElement('div'),this.basicWindow.setAttribute('unselectable','on'),this.basicWindow.className='window',this.basicWindow.id=this.basicWindow.className+'_'+this.id,this.basicWindow.style.display='none',this.editor.plugins.appendChild(this.basicWindow),this.createToolbar(),this.createContext(),this.createFoot()}},{key:'createToolbar',value:function createToolbar(){this.toolbar=document.createElement('div'),this.toolbar.setAttribute('unselectable','on'),this.toolbar.className='windowToolbar';var l=document.createElement('span');l.setAttribute('unselectable','on'),l.innerText=this.title;var s=document.createElement('button');s.setAttribute('unselectable','on'),s.title='\u5173\u95ED',s.className='windowCloseButton';var m=this;s.onclick=function(){m.close()},this.toolbar.appendChild(l),this.toolbar.appendChild(s),this.basicWindow.appendChild(this.toolbar)}},{key:'createContext',value:function createContext(){this.context=document.createElement('div'),this.context.setAttribute('unselectable','on'),this.context.className='windowContext',this.loadContext(this.context),this.basicWindow.appendChild(this.context)}},{key:'createFoot',value:function createFoot(){this.foot=document.createElement('div'),this.foot.setAttribute('unselectable','on'),this.foot.className='windowFoot';var l=document.createElement('button');l.innerText='\u63D0\u4EA4',l.className='windowSubmitButton';var s=this;l.onclick=function(){s.basicWindow.blur(),s.editor.context.focus();var u=s.click();u&&s.close()},this.foot.appendChild(l),this.basicWindow.appendChild(this.foot)}},{key:'show',value:function show(l){this.setDefaultValue(),this.basicWindow.style.display='block',l&&(this.editor.shield.style.display='block')}},{key:'setTag',value:function setTag(l){this.tag=l}},{key:'setRange',value:function setRange(l){this.range=l}},{key:'close',value:function close(){this.basicWindow.style.display='none',this.editor.shield.style.display='none'}},{key:'setWidth',value:function setWidth(l){this.basicWindow.style.width=l}},{key:'setContextHeight',value:function setContextHeight(l){this.context.style.height=l}},{key:'setLabWidth',value:function setLabWidth(l){this.labWidth=l}},{key:'setFormItemWidth',value:function setFormItemWidth(l){this.formItemWidth=l}},{key:'addForm',value:function addForm(l,s,m){var u=document.createElement('form');return u.setAttribute('unselectable','on'),u.action=s,u.method=m,l.appendChild(u),u}},{key:'addGroup',value:function addGroup(l,s){var m=document.createElement('div');m.setAttribute('unselectable','on'),m.style.margin='1px',m.style.padding='1px';var u=document.createElement('div');u.setAttribute('unselectable','on'),u.innerText=s;var p=document.createElement('div');return p.setAttribute('unselectable','on'),p.className='windowGroupContext',m.appendChild(u),m.appendChild(p),l.appendChild(m),p}},{key:'addItem',value:function addItem(l){var s=document.createElement('div');return s.setAttribute('unselectable','on'),s.style.margin='5px',l.appendChild(s),s}},{key:'addLabItem',value:function addLabItem(l,s){var m=document.createElement('div');return m.setAttribute('unselectable','on'),m.style.width=this.labWidth,m.style.display='inline-block',m.style.textAlign='right',m.style.verticalAlign='top',m.innerText=s,l.appendChild(m),m}},{key:'addFormItem',value:function addFormItem(l,s,m){var u=document.createElement('div');u.setAttribute('unselectable','on'),u.style.width=this.formItemWidth,u.style.display='inline-block',u.style.verticalAlign='top';this.addLabItem(l,s);return u.appendChild(m),l.appendChild(u),u}},{key:'loadContext',value:function loadContext(){}},{key:'click',value:function click(){alert('\u63D0\u4EA4\u6309\u94AE\u5B50\u7C7B\u5B9E\u73B0')}},{key:'setDefaultValue',value:function setDefaultValue(){}}]),t}(),ShowSource=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api;'source'==m.className?(m.className='source_open',this.editor.context.style.display='none',this.editor.source.style.display='block',this.editor.source.value=u.htmlFormat(this.editor.context.innerHTML,!0),Array.from(this.editor.toolbar.children).map(function(p){p.disabled=!0,p.style.cursor='default'}),Array.from(this.editor.plugins.childNodes).map(function(p){p.style.display='none'}),m.disabled=!1,m.style.cursor='pointer',this.editor.source.focus()):(m.className='source',this.editor.source.style.display='none',this.editor.context.style.display='block',this.editor.context.innerHTML=u.htmlFormat(this.editor.source.value,!1),Array.from(this.editor.toolbar.children).map(function(p){p.disabled=!1,p.style.cursor='pointer'}),this.editor.context.focus())}}]),l}(CommandBtn),Bold=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.bold();p&&('bold'==m.className?m.className='bold_open':m.className='bold')}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'B');this.button.className=null==u?this.config.name:this.config.name+'_open'}}]),l}(CommandBtn),Italic=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.italic();p&&('italic'==m.className?m.className='italic_open':m.className='italic')}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'I');this.button.className=null==u?this.config.name:this.config.name+'_open'}}]),l}(CommandBtn),Underline=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.underline();p&&('underline'==m.className?m.className='underline_open':m.className='underline')}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'U');this.button.className=null==u?this.config.name:this.config.name+'_open'}}]),l}(CommandBtn),StrikeThrough=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.strikeThrough();p&&('strikeThrough'==m.className?m.className='strikeThrough_open':m.className='strikeThrough')}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'STRIKE');this.button.className=null==u?this.config.name:this.config.name+'_open'}}]),l}(CommandBtn),Superscript=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.superscript();p&&('superscript'==m.className?m.className='superscript_open':m.className='superscript')}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'SUP');this.button.className=null==u?this.config.name:this.config.name+'_open'}}]),l}(CommandBtn),Subscript=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.subscript();p&&('subscript'==m.className?m.className='subscript_open':m.className='subscript')}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'SUB');this.button.className=null==u?this.config.name:this.config.name+'_open'}}]),l}(CommandBtn),SizeSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api;m.fontSize(s)}},{key:'configItemNode',value:function configItemNode(s,m){s.innerText='';var u=document.createElement('font');u.setAttribute('unselectable','on'),u.size=m,u.innerText=m,s.appendChild(u)}}]),l}(Select),FontSize=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new SizeSelect(this.editor,this.config.items,this.button)}},{key:'click',value:function click(s,m){this.select.btnClick(s,m)}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'FONT');Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){null!=u&&b.size==u.size&&(f=!0)})}),f&&(p.className='selectitemOn')})}}]),l}(CommandBtn),FontSizeStyleSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api,u=m.getRange();m.seletTextBil(u,function(p,f){if(f){var y=p.parentNode;if('SPAN'==y.nodeName&&p.nodeValue==u.toString())y.style.fontSize=s;else{var b=document.createElement('span');return b.style.fontSize=s,''==p.nodeValue&&(p.nodeValue='\u200B'),b.appendChild(p.cloneNode()),y.replaceChild(b,p),b}}})}},{key:'configItemNode',value:function configItemNode(s,m){s.innerText='';var u=document.createElement('span');u.setAttribute('unselectable','on'),u.style.fontSize=m,u.innerText=m,s.appendChild(u)}}]),l}(Select),FontSizeStyle=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new FontSizeStyleSelect(this.editor,this.config.items,this.button)}},{key:'click',value:function click(s,m){this.select.btnClick(s,m)}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'SPAN');Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){null!=u&&b.style.fontSize==u.style.fontSize&&(f=!0)})}),f&&(p.className='selectitemOn')})}}]),l}(CommandBtn),FontNameSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api;m.fontName(s)}},{key:'configItemNode',value:function configItemNode(s,m){s.innerText='';var u=document.createElement('font');u.setAttribute('unselectable','on'),u.face=m,u.innerText=m,s.appendChild(u)}}]),l}(Select),FontName=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new FontNameSelect(this.editor,this.config.items,this.button)}},{key:'click',value:function click(s,m){this.select.btnClick(s,m)}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'FONT');Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){null!=u&&b.face==u.face&&(f=!0)})}),f&&(p.className='selectitemOn')})}}]),l}(CommandBtn),AlignSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api;'\u94FA\u6EE1'==s?m.justifyFull():'\u5C45\u4E2D'==s?m.justifyCenter():'\u9760\u5DE6'==s?m.justifyLeft():'\u9760\u53F3'==s&&m.justifyRight()}},{key:'configItemNode',value:function configItemNode(s,m){s.innerText='';var u=document.createElement('div');u.setAttribute('unselectable','on'),u.title=m,'\u94FA\u6EE1'==m?u.className='justifyFull':'\u5C45\u4E2D'==m?u.className='justifyCenter':'\u9760\u5DE6'==m?u.className='justifyLeft':'\u9760\u53F3'==m&&(u.className='justifyRight'),s.appendChild(u)}}]),l}(Select),Align=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new AlignSelect(this.editor,this.config.items,this.button)}},{key:'click',value:function click(s,m){this.select.btnClick(s,m)}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'DIV');null!=u&&('center'==u.style.textAlign?Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){'justifyCenter'==b.className&&(f=!0)})}),f&&(p.className='selectitemOn')}):'justify'==u.style.textAlign?Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){'justifyFull'==b.className&&(f=!0)})}),f&&(p.className='selectitemOn')}):'right'==u.style.textAlign?Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){'justifyRight'==b.className&&(f=!0)})}),f&&(p.className='selectitemOn')}):Array.from(this.select.select.childNodes).map(function(p){p.className='selectitem';var f=!1;Array.from(p.childNodes).map(function(y){Array.from(y.childNodes).map(function(b){'justifyLeft'==b.className&&(f=!0)})}),f&&(p.className='selectitemOn')}))}}]),l}(CommandBtn),ForeColorSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api;m.foreColor(s)}},{key:'configItemNode',value:function configItemNode(s,m){s.style.background=m}}]),l}(GroupSelect),ForeColor=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new ForeColorSelect(this.editor,this.config.items,this.button)}},{key:'click',value:function click(s,m){this.select.btnClick(s,m)}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=s.getElement(m,'FONT');Array.from(this.select.select.childNodes).map(function(p){Array.from(p.childNodes).map(function(f){f.className='groupselectitem',null!=u&&f.title.toUpperCase()==u.color.toUpperCase()&&(f.className='groupselectitemOn')})})}}]),l}(CommandBtn),BackColorSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api;m.backColor(s)}},{key:'configItemNode',value:function configItemNode(s,m){s.style.background=m}}]),l}(GroupSelect),BackColor=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new BackColorSelect(this.editor,this.config.items,this.button)}},{key:'click',value:function click(s,m){this.select.btnClick(s,m)}},{key:'isEnableCall',value:function isEnableCall(){var s=new Api,m=s.getRange(),u=!1,p=s.getElement(m,'FONT');Array.from(this.select.select.childNodes).map(function(f){Array.from(f.childNodes).map(function(y){y.className='groupselectitem',null!=p&&y.style.backgroundColor==p.style.backgroundColor&&(y.className='groupselectitemOn',u=!0)})}),u||(p=s.getElement(m,'SPAN'),Array.from(this.select.select.childNodes).map(function(f){Array.from(f.childNodes).map(function(y){y.className='groupselectitem',null!=p&&y.style.backgroundColor==p.style.backgroundColor&&(y.className='groupselectitemOn')})}))}}]),l}(CommandBtn),RemoveFormat=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=new Api,p=u.removeFormat()}}]),l}(CommandBtn),Indent=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=new Api,p=u.indent()}}]),l}(CommandBtn),Outdent=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=new Api,p=u.outdent()}}]),l}(CommandBtn),InsertOrderedList=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.insertOrderedList();p&&('insertOrderedList'==m.className?m.className='insertOrderedList_open':m.className='insertOrderedList')}}]),l}(CommandBtn),InsertUnorderedList=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){var u=new Api,p=u.insertUnorderedList();p&&('insertUnorderedList'==m.className?m.className='insertUnorderedList_open':m.className='insertUnorderedList')}}]),l}(CommandBtn),ImageSetWindow=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadContext',value:function loadContext(s){this.setContextHeight('80px'),this.setWidth('300px'),this.setLabWidth('80px');var m=this.addItem(s);this.numWidth=document.createElement('input'),this.numWidth.setAttribute('unselectable','on'),this.numWidth.setAttribute('name','numWidth'),this.numWidth.setAttribute('type','text');var u=this.addFormItem(m,'\u5BBD\u5EA6\uFF1A',this.numWidth),p=this.addItem(s);this.numHeight=document.createElement('input'),this.numHeight.setAttribute('unselectable','on'),this.numHeight.setAttribute('name','numHeight'),this.numHeight.setAttribute('type','text');this.addFormItem(p,'\u9AD8\u5EA6\uFF1A',this.numHeight)}},{key:'setDefaultValue',value:function setDefaultValue(){null!=this.tag&&(this.numWidth.value=this.tag.style.width,this.numHeight.value=this.tag.style.height)}},{key:'click',value:function click(){var s=this.numWidth.value,m=this.numHeight.value;return null!=this.tag&&(this.tag.style.width=s,this.tag.style.height=m,!0)}}]),l}(BasicWindow),ImageRightMenu=function(t){function l(s,m,u,p){_classCallCheck(this,l);var f=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m,u,p));return f.window=new ImageSetWindow(f.editor,'img','\u56FE\u7247\u8BBE\u7F6E'),f}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){this.window.setTag(this.tag),this.window.show(!0)}}]),l}(RightMenu),InsertImage=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new ImageRightMenu(this.editor,this.config.items,this.button,'img')}},{key:'click',value:function click(){var u=prompt('\u8BF7\u8F93\u5165src\uFF1A');if(null!=u&&''!=u){var p=new Api,f=p.insertImage(u)}}}]),l}(CommandBtn),InsertAudio=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=prompt('\u8BF7\u8F93\u5165src\uFF1A');if(null!=u&&''!=u){var p=new Api,f=document.createElement('audio');f.src=u,f.controls='controls',f.innerText='\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 audio \u6807\u7B7E\u3002',p.insertNodeAtCursor(p.getRange(),f)}}}]),l}(CommandBtn),InsertVideo=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=prompt('\u8BF7\u8F93\u5165src\uFF1A');if(null!=u&&''!=u){var p=new Api,f=document.createElement('video');f.src=u,f.controls='controls',f.innerText='\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 video \u6807\u7B7E\u3002',p.insertNodeAtCursor(p.getRange(),f)}}}]),l}(CommandBtn),InsertAnchor=function(t){function l(s,m){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=prompt('\u8BF7\u8F93\u5165\u6807\u8BB0\u540D\u79F0\uFF1A');if(null!=u&&''!=u){var p=document.createElement('br'),f=new Api,y=document.createElement('a');y.className='anchor',y.name=u,y.href='#',y.innerText=u;var b=f.insertNodeAtCursor(f.getRange(),y);f.getRange().setStartAfter(y),f.getRange().setEndAfter(y),b}}}]),l}(CommandBtn),LinkSetWindow=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadContext',value:function loadContext(s){this.setContextHeight('50px'),this.setWidth('300px'),this.setLabWidth('80px');var m=this.addItem(s);this.urlLink=document.createElement('input'),this.urlLink.setAttribute('unselectable','on'),this.urlLink.setAttribute('name','urlLink'),this.urlLink.setAttribute('type','url');this.addFormItem(m,'Link\uFF1A',this.urlLink)}},{key:'setDefaultValue',value:function setDefaultValue(){null!=this.tag&&null!=this.tag.href&&''!=this.tag.href&&(this.urlLink.value=this.tag.href)}},{key:'click',value:function click(){var s=this.urlLink.value;return null!=this.tag&&(this.tag.href=s,!0)}}]),l}(BasicWindow),LinkRightMenu=function(t){function l(s,m,u,p){_classCallCheck(this,l);var f=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m,u,p));return f.window=new LinkSetWindow(f.editor,'link','\u8D85\u94FE\u63A5\u8BBE\u7F6E'),f}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){this.window.setTag(this.tag),this.window.show(!0)}}]),l}(RightMenu),CreateLink=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.select=new LinkRightMenu(this.editor,this.config.items,this.button,'a')}},{key:'click',value:function click(){var u=prompt('\u8BF7\u8F93\u5165link\uFF1A');if(null!=u&&''!=u){var p=new Api,f=p.createLink(u)}}}]),l}(CommandBtn),Unlink=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=new Api,p=u.unlink()}}]),l}(CommandBtn),InsertHr=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=new Api,p=document.createElement('br');u.insertNodeAtCursor(u.getRange(),p);var f=document.createElement('hr');u.insertNodeAtCursor(u.getRange(),f)}}]),l}(CommandBtn),TableApi=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:'createTable',value:function createTable(l,s,m,u,p,f,y){if(null!=l){var b=document.createElement('br'),C=new Api,k=document.createElement('table');k.style.width=p,k.style.borderCollapse='collapse',k.style.border='1px solid '+s,k.style.background=m,k.align=u;for(var N,_=0;_<f;_++){N=k.insertRow(_);for(var w,x=0;x<y;x++)w=N.insertCell(x),w.style.border=k.style.border,w.appendChild(b.cloneNode())}return C.insertNodeAtCursor(l,b.cloneNode()),C.insertNodeAtCursor(l,k)}return!1}},{key:'editTable',value:function editTable(l,s,m,u,p){if(l.style.width=p,l.style.borderCollapse='collapse',l.style.border='1px solid '+s,l.style.background=m,l.align=u,null!=l)for(var y,f=0;f<l.rows.length;f++){y=l.rows[f];for(var C,b=0;b<y.cells.length;b++)C=y.cells[b],C.style.border=l.style.border}return!0}},{key:'addRow',value:function addRow(l,s){var m=document.createElement('br');if(null!=l){var u=new Api,p=u.getElement(l,'TABLE');if(null!=p){var f=u.getElement(l,'TR');if(null!=f){var y=u.getElement(l,'TD');if(null!=y){for(var b=f.rowIndex,C=y.cellIndex,k=0,_=0,x=0;x<p.rows.length;x++)for(var w=p.rows[x],E=0,A=0;A<w.cells.length;A++){var R=w.cells[A],I=R.rowSpan,T=R.colSpan;0==x&&(k+=T),b>=x&&b<x+I&&1<I&&(_+=T,R.rowSpan=I+1),E+=T}'After'==s&&b++;for(var w,N=p.insertRow(b),x=0;x<k-_;x++)w=N.insertCell(x),w.style.border=p.style.border,w.appendChild(m.cloneNode())}}}}}},{key:'removeRow',value:function removeRow(l){var s=document.createElement('br');if(null!=l){var m=new Api,u=m.getElement(l,'TABLE');if(null!=u){var p=m.getElement(l,'TR');if(null!=p){var f=m.getElement(l,'TD');if(null!=f){for(var y=p.rowIndex,b=f.cellIndex,k=0;k<u.rows.length;k++)for(var _=u.rows[k],x=0;x<_.cells.length;x++){var w=_.cells[x],E=w.rowSpan,A=w.colSpan;if(y>k&&y<k+E&&1<E&&(w.rowSpan=E-1),y==k&&1<E)for(var R=y+1;R<y+E;R++)for(var T,I=0;I<A;I++)T=u.rows[R].insertCell(b),T.style.border=u.style.border,T.appendChild(s.cloneNode())}u.deleteRow(y)}}}}}},{key:'addColumn',value:function addColumn(l,s){var m=document.createElement('br');if(null!=l){var u=new Api,p=u.getElement(l,'TABLE');if(null!=p){var f=u.getElement(l,'TR');if(null!=f){var y=u.getElement(l,'TD');if(null!=y){for(var b=f.rowIndex,C=y.cellIndex,k=0,_=0;_<p.rows.length;_++)for(var N=p.rows[_],x=0,w=0;w<N.cells.length;w++){var E=N.cells[w],A=E.rowSpan,R=E.colSpan;b>_&&b<_+A&&(k+=R),_==b&&w==C&&(k+=x),x+=R}'After'==s&&k++;for(var _=0;_<p.rows.length;_++)for(var N=p.rows[_],x=0,w=0;w<N.cells.length;w++){var E=N.cells[w],A=E.rowSpan,R=E.colSpan;if(k==x||k<x+R&&k>x){if(1==R){var I=N.insertCell(w);I.style.border=p.style.border,I.appendChild(m.cloneNode())}else++E.colSpan;1<A&&(_=_+A-1)}x+=R}}}}}}},{key:'removeCoolumn',value:function removeCoolumn(l){if(null!=l){var s=new Api,m=s.getElement(l,'TABLE');if(null!=m){var u=s.getElement(l,'TR');if(null!=u){var p=s.getElement(l,'TD');if(null!=p){for(var f=u.rowIndex,y=p.cellIndex,b=0,C=0;C<m.rows.length;C++)for(var k=m.rows[C],_=0,N=0;N<k.cells.length;N++){var x=k.cells[N],w=x.rowSpan,E=x.colSpan;f>C&&f<C+w&&(b+=E),C==f&&N==y&&(b+=_),_+=E}for(var C=0;C<m.rows.length;C++)for(var k=m.rows[C],_=0,N=0;N<k.cells.length;N++){var x=k.cells[N],w=x.rowSpan,E=x.colSpan;(b==_||b<_+E&&b>_)&&(1==E?k.deleteCell(N):--x.colSpan,1<w&&(C=C+w-1)),_+=E}}}}}}},{key:'mergeCells',value:function mergeCells(l,s){if(null!=l){var m=new Api,u=m.getElement(l,'TABLE');if(null!=u){var p=m.getElement(l,'TR');if(null!=p){var f=m.getElement(l,'TD');if(null!=f){for(var y=p.rowIndex,b=f.cellIndex,C=0,k=0;k<u.rows.length;k++)for(var _=u.rows[k],N=0,x=0;x<_.cells.length;x++){var w=_.cells[x],E=w.rowSpan,A=w.colSpan;y>k&&y<k+E&&(C+=A),k==y&&x==b&&(C+=N),N+=A}if('Right'==s){for(var k=y,_=b+f.colSpan,N=C+f.colSpan,w=0;w<u.rows.length;w++){var E=u.rows[w],A=0;if(k==w&&_>=E.cells.length)return void alert('\u540E\u9762\u6CA1\u6709\u5355\u5143\u683C\u53EF\u5408\u5E76');for(var R=0;R<E.cells.length;R++){var I=E.cells[R],T=I.rowSpan,S=I.colSpan;if(A<N&&y>w&&y<w+T&&(N-=S),N==A&&k>w&&k<w+T)return void alert('\u65E0\u6CD5\u5408\u5E76,\u76EE\u6807\u5355\u5143\u683C\u4E0D\u5230\u540C\u4E00\u884C\u4E0A');A+=S}}var x=u.rows[k];if(null!=x){var w=x.cells[_];if(null!=w)if(f.rowSpan==w.rowSpan){var E=f.rowSpan+w.rowSpan,A=f.colSpan+w.colSpan;f.colSpan=A,u.rows[k].deleteCell(_)}else return void alert('\u88AB\u5408\u5E76\u7684\u5355\u5143\u683C\u6240\u8DE8\u884C\u6570\u4E0E\u5408\u5E76\u7684\u5355\u5143\u683C\u6240\u8DE8\u7684\u884C\u6570\u4E0D\u76F8\u7B49\uFF0C\u65E0\u6CD5\u5408\u5E76')}}else{var k=y+f.rowSpan,_=C;if(k>=u.rows.length)return void alert('\u540E\u9762\u6CA1\u6709\u5355\u5143\u683C\u53EF\u5408\u5E76');for(var x=0;x<u.rows.length;x++)for(var w=u.rows[x],E=0,A=0;A<w.cells.length;A++){var R=w.cells[A],I=R.rowSpan,T=R.colSpan;if(E<C&&k>x&&k<x+I&&(_-=T),E<C&&k==x&&1<T){if(E+T>_&&E<_)return void alert('\u65E0\u6CD5\u5408\u5E76,\u76EE\u6807\u5355\u5143\u683C\u4E0D\u5230\u540C\u4E00\u5217\u4E0A');_-=T-1}E+=T}var N=u.rows[k];if(null!=N){var x=N.cells[_];if(null!=x)if(f.colSpan==x.colSpan){var w=f.rowSpan+x.rowSpan,E=f.colSpan+x.colSpan;f.rowSpan=w,u.rows[k].deleteCell(_)}else return void alert('\u88AB\u5408\u5E76\u7684\u5355\u5143\u683C\u6240\u8DE8\u5217\u6570\u4E0E\u5408\u5E76\u7684\u5355\u5143\u683C\u6240\u8DE8\u7684\u5217\u6570\u4E0D\u76F8\u7B49\uFF0C\u65E0\u6CD5\u5408\u5E76')}}}}}}}},{key:'splitCell',value:function splitCell(l){var s=document.createElement('br');if(null!=l){var m=new Api,u=m.getElement(l,'TABLE');if(null!=u){var p=m.getElement(l,'TR');if(null!=p){var f=m.getElement(l,'TD');if(null!=f)for(var y=p.rowIndex,b=f.cellIndex,C=f.rowSpan,k=f.colSpan,_=y;_<y+C;_++)for(var N=b;N<b+k;N++)if(_==y&&N==b)f.rowSpan=1,f.colSpan=1;else{var x=u.rows[_].insertCell(N);x.style.border=u.style.border,x.appendChild(s.cloneNode())}}}}}},{key:'addCell',value:function addCell(l){var s=document.createElement('br');if(null!=l){var m=new Api,u=m.getElement(l,'TABLE');if(null!=u){var p=m.getElement(l,'TR');if(null!=p){var f=m.getElement(l,'TD');if(null!=f){var y=p.rowIndex,b=f.cellIndex,C=p.insertCell(p.length);C.style.border=u.style.border,C.appendChild(s.cloneNode())}}}}}},{key:'delCell',value:function delCell(l){document.createElement('br');if(null!=l){var m=new Api,u=m.getElement(l,'TABLE');if(null!=u){var p=m.getElement(l,'TR');if(null!=p){var f=m.getElement(l,'TD');if(null!=f){var y=p.rowIndex,b=f.cellIndex;p.deleteCell(b)}}}}}},{key:'setSelectCellBackground',value:function setSelectCellBackground(l,s){var m=new Api;return m.seletTextBil(l,function(u,p){p&&(u.style.background=s)},'TD'),!0}}]),t}(),TableSelect=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api,u=new TableApi;'\u6DFB\u52A0\u8868\u683C'==s?u.createTable(m.getRange(),'#000000','center','500px',5,5):'\u524D\u9762\u52A0\u4E00\u884C'==s?u.addRow(m.getRange()):'\u540E\u9762\u52A0\u4E00\u884C'==s?u.addRow(m.getRange(),'After'):'\u5220\u9664\u884C'==s?u.removeRow(m.getRange()):'\u524D\u9762\u52A0\u4E00\u5217'==s?u.addColumn(m.getRange()):'\u540E\u9762\u52A0\u4E00\u5217'==s?u.addColumn(m.getRange(),'After'):'\u5220\u9664\u5217'==s?u.removeCoolumn(m.getRange()):'\u5411\u4E0B\u5408\u5E76\u5355\u5143\u683C'==s?u.mergeCells(m.getRange()):'\u5411\u53F3\u5408\u5E76\u5355\u5143\u683C'==s?u.mergeCells(m.getRange(),'Right'):'\u62C6\u5206\u5355\u5143\u683C'==s?u.splitCell(m.getRange()):'\u6DFB\u52A0\u8FB9\u6846'==s||'\u6E05\u9664\u8FB9\u6846'==s}},{key:'configItemNode',value:function configItemNode(s,m){s.style.padding=0;var u=document.createElement('div');u.setAttribute('unselectable','on'),u.title=m,'\u6DFB\u52A0\u8868\u683C'==m?u.className='table':'\u524D\u9762\u52A0\u4E00\u884C'==m?u.className='tableRowPlusBefore':'\u540E\u9762\u52A0\u4E00\u884C'==m?u.className='tableRowPlusAfter':'\u5220\u9664\u884C'==m?u.className='tableRowRemove':'\u524D\u9762\u52A0\u4E00\u5217'==m?u.className='tableColumnPlusBefore':'\u540E\u9762\u52A0\u4E00\u5217'==m?u.className='tableColumnPlusAfter':'\u5220\u9664\u5217'==m?u.className='tableColumnRemove':'\u5411\u4E0B\u5408\u5E76\u5355\u5143\u683C'==m?u.className='tableMergeCellsDown':'\u5411\u53F3\u5408\u5E76\u5355\u5143\u683C'==m?u.className='tableMergeCellsRight':'\u62C6\u5206\u5355\u5143\u683C'==m?u.className='tableCallSplit':'\u6DFB\u52A0\u8FB9\u6846'==m?u.className='tableBorder':'\u6E05\u9664\u8FB9\u6846'==m&&(u.className='tableBorderNone'),s.appendChild(u)}},{key:'configGroupNode',value:function configGroupNode(s){s.style.borderBottom='1px solid #CAE1FF',s.style.margin='2px'}}]),l}(GroupSelect),TableRightMenu=function(t){function l(s,m,u,p,f){_classCallCheck(this,l);var y=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m,u,p));return y.window=f,y.windowCell=new CellSetWindow(y.editor,'cell','\u9009\u4E2D\u5355\u5143\u683C\u80CC\u666F\u8BBE\u7F6E'),y}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s){var m=new Api,u=new TableApi;'\u914D\u7F6E\u8868\u683C'==s?(this.window.IsEdit=!0,this.window.numRow.disabled=!0,this.window.numCol.disabled=!0,this.window.setTag(this.tag),this.window.show(!0)):'\u524D\u9762\u52A0\u4E00\u884C'==s?u.addRow(m.getRange()):'\u540E\u9762\u52A0\u4E00\u884C'==s?u.addRow(m.getRange(),'After'):'\u5220\u9664\u884C'==s?u.removeRow(m.getRange()):'\u524D\u9762\u52A0\u4E00\u5217'==s?u.addColumn(m.getRange()):'\u540E\u9762\u52A0\u4E00\u5217'==s?u.addColumn(m.getRange(),'After'):'\u5220\u9664\u5217'==s?u.removeCoolumn(m.getRange()):'\u5411\u4E0B\u5408\u5E76\u5355\u5143\u683C'==s?u.mergeCells(m.getRange()):'\u5411\u53F3\u5408\u5E76\u5355\u5143\u683C'==s?u.mergeCells(m.getRange(),'Right'):'\u62C6\u5206\u5355\u5143\u683C'==s?u.splitCell(m.getRange()):'\u6DFB\u52A0\u8FB9\u6846'==s||'\u6E05\u9664\u8FB9\u6846'==s||('\u6DFB\u52A0\u5355\u5143\u683C'==s?u.addCell(m.getRange()):'\u5220\u9664\u5355\u5143\u683C'==s?u.delCell(m.getRange()):'\u8BBE\u7F6E\u9009\u4E2D\u7684\u5355\u5143\u683C\u80CC\u666F'==s&&(this.windowCell.setRange(m.getRange()),this.windowCell.show(!0)))}},{key:'configItemNode',value:function configItemNode(s,m){s.innerText='';var u=document.createElement('div');u.setAttribute('unselectable','on');var p=document.createElement('div');p.setAttribute('unselectable','on'),p.title=m,p.style.float='left','\u914D\u7F6E\u8868\u683C'==m?p.className='table':'\u524D\u9762\u52A0\u4E00\u884C'==m?p.className='tableRowPlusBefore':'\u540E\u9762\u52A0\u4E00\u884C'==m?p.className='tableRowPlusAfter':'\u5220\u9664\u884C'==m?p.className='tableRowRemove':'\u524D\u9762\u52A0\u4E00\u5217'==m?p.className='tableColumnPlusBefore':'\u540E\u9762\u52A0\u4E00\u5217'==m?p.className='tableColumnPlusAfter':'\u5220\u9664\u5217'==m?p.className='tableColumnRemove':'\u5411\u4E0B\u5408\u5E76\u5355\u5143\u683C'==m?p.className='tableMergeCellsDown':'\u5411\u53F3\u5408\u5E76\u5355\u5143\u683C'==m?p.className='tableMergeCellsRight':'\u62C6\u5206\u5355\u5143\u683C'==m?p.className='tableCallSplit':'\u6DFB\u52A0\u8FB9\u6846'==m?p.className='tableBorder':'\u6E05\u9664\u8FB9\u6846'==m?p.className='tableBorderNone':'\u6DFB\u52A0\u5355\u5143\u683C'==m?p.className='tableAddCell':'\u5220\u9664\u5355\u5143\u683C'==m?p.className='tableDelCell':'\u8BBE\u7F6E\u9009\u4E2D\u7684\u5355\u5143\u683C\u80CC\u666F'==m&&(p.className='tableSelectColor');var f=document.createElement('div');f.setAttribute('unselectable','on'),f.innerText=m,f.style.float='left',u.appendChild(p),u.appendChild(f),s.appendChild(u)}},{key:'configGroupNode',value:function configGroupNode(s){s.style.borderBottom='1px solid #CAE1FF',s.style.margin='2px'}}]),l}(RightMenu),TableSetWindow=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadContext',value:function loadContext(s){this.setContextHeight('180px'),this.setWidth('300px'),this.setLabWidth('80px');var m=this.addItem(s);this.numWidth=document.createElement('input'),this.numWidth.setAttribute('unselectable','on'),this.numWidth.setAttribute('name','numWidth'),this.numWidth.setAttribute('type','text'),this.numWidth.value='500px';var u=this.addFormItem(m,'\u5BBD\u5EA6\uFF1A',this.numWidth),p=this.addItem(s);this.borderColor=document.createElement('input'),this.borderColor.setAttribute('unselectable','on'),this.borderColor.setAttribute('name','borderColor'),this.borderColor.setAttribute('type','color'),this.borderColor.value='#000000';var f=this.addFormItem(p,'\u8FB9\u6846\u989C\u8272\uFF1A',this.borderColor),y=this.addItem(s);this.backgroundColor=document.createElement('input'),this.backgroundColor.setAttribute('unselectable','on'),this.backgroundColor.setAttribute('name','backgroundColor'),this.backgroundColor.setAttribute('type','color'),this.backgroundColor.value='#FFFFFF';var b=this.addFormItem(y,'\u80CC\u666F\u989C\u8272\uFF1A',this.backgroundColor),C=this.addItem(s);this.align=document.createElement('select'),this.align.setAttribute('unselectable','on'),this.align.setAttribute('name','align'),this.alignItemLeft=document.createElement('option'),this.alignItemLeft.value='left',this.alignItemLeft.text='\u9760\u5DE6',this.align.appendChild(this.alignItemLeft),this.alignItemCenter=document.createElement('option'),this.alignItemCenter.value='center',this.alignItemCenter.text='\u5C45\u4E2D',this.align.appendChild(this.alignItemCenter),this.alignItemRight=document.createElement('option'),this.alignItemRight.value='right',this.alignItemRight.text='\u9760\u53F3',this.align.add(this.alignItemRight),this.align.selectedIndex=0;var k=this.addFormItem(C,'\u8868\u683C\u5BF9\u9F50\uFF1A',this.align),_=this.addItem(s);this.numRow=document.createElement('input'),this.numRow.setAttribute('unselectable','on'),this.numRow.setAttribute('name','numRow'),this.numRow.setAttribute('type','number'),this.numRow.value=5;var N=this.addFormItem(_,'\u884C\u6570\uFF1A',this.numRow),x=this.addItem(s);this.numCol=document.createElement('input'),this.numCol.setAttribute('unselectable','on'),this.numCol.setAttribute('name','numCol'),this.numCol.setAttribute('type','number'),this.numCol.value=5;this.addFormItem(x,'\u5217\u6570\uFF1A',this.numCol)}},{key:'click',value:function click(){var s=new TableApi;return!1==this.IsEdit?s.createTable(this.range,this.borderColor.value,this.backgroundColor.value,this.align.options[this.align.selectedIndex].value,this.numWidth.value,this.numRow.value,this.numCol.value):s.editTable(this.tag,this.borderColor.value,this.backgroundColor.value,this.align.options[this.align.selectedIndex].value,this.numWidth.value)}}]),l}(BasicWindow),CellSetWindow=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadContext',value:function loadContext(s){this.setContextHeight('40px'),this.setWidth('300px'),this.setLabWidth('80px');var m=this.addItem(s);this.backgroundColor=document.createElement('input'),this.backgroundColor.setAttribute('unselectable','on'),this.backgroundColor.setAttribute('name','borderColor'),this.backgroundColor.setAttribute('type','color'),this.backgroundColor.value='#FFFFFF';this.addFormItem(m,'\u80CC\u666F\u989C\u8272\uFF1A',this.backgroundColor)}},{key:'click',value:function click(){var s=new TableApi;return s.setSelectCellBackground(this.range,this.backgroundColor.value)}}]),l}(BasicWindow),Table=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.window=new TableSetWindow(this.editor,'table','\u8868\u683C\u8BBE\u7F6E'),this.select=new TableRightMenu(this.editor,this.config.items,this.button,'table',this.window)}},{key:'click',value:function click(){var u=new Api;this.window.IsEdit=!1,this.window.numRow.disabled=!1,this.window.numCol.disabled=!1,this.window.setRange(u.getRange()),this.window.show(!0)}}]),l}(CommandBtn),InsertHTMLWindow=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadContext',value:function loadContext(s){this.setContextHeight('200px'),this.setWidth('880px'),this.setLabWidth('80px'),this.setFormItemWidth('750px');var m=this.addItem(s);this.textHtml=document.createElement('textarea'),this.textHtml.setAttribute('unselectable','on'),this.textHtml.setAttribute('name','textHtml'),this.textHtml.rows=10,this.textHtml.cols=100;this.addFormItem(m,'HTML\uFF1A',this.textHtml)}},{key:'click',value:function click(){var s=this.textHtml.value;if(null!=s&&''!=s&&null!=this.range){var m=new Api,u=m.insertHtmlAtCursor(this.range,s);if(u)return this.textHtml.value='',!0}return!1}}]),l}(BasicWindow),InsertHTML=function(t){function l(s,m){_classCallCheck(this,l);var u=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,s,m));return u.loadItem(),u}return _inherits(l,t),_createClass(l,[{key:'loadItem',value:function loadItem(){this.window=new InsertHTMLWindow(this.editor,'insertHtml','\u63D2\u5165HTML')}},{key:'click',value:function click(){var u=new Api;this.window.setRange(u.getRange()),this.window.show(!0)}}]),l}(CommandBtn),Formatpagebreak=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=new Api,p=document.createElement('div');p.contentEditable=!1,p.setAttribute('unselectable','on'),p.style.pageBreakAfter='always',p.title='\u5206\u9875',p.className='pagebreak',u.insertNodeAtCursor(u.getRange(),p)}}]),l}(CommandBtn),Print=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){var u=this.editor.getContext(),p=window.open('','_blank');p.document.write(u),p.print(),p.document.close(),p.close()}}]),l}(CommandBtn),Fullscreen=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(s,m){'fullscreen'==m.className?(this.top=this.editor.editor.style.top,this.left=this.editor.editor.style.left,this.width=this.editor.editor.style.width,this.height=this.editor.editor.style.height,this.editor.editor.style.top=0,this.editor.editor.style.left=0,this.editor.editor.style.width='100%',this.editor.editor.style.height='100%',this.editor.editor.style.float='left',this.editor.editor.style.position='fixed',m.className='fullscreen_open'):(this.editor.editor.style.top=this.top,this.editor.editor.style.left=this.left,this.editor.editor.style.width=this.width,this.editor.editor.style.height=this.height,this.editor.editor.style.float='none',this.editor.editor.style.position='relative',m.className='fullscreen'),this.editor.context.style.top=this.editor.toolbar.offsetHeight,this.editor.source.style.top=this.editor.toolbar.offsetHeight,this.editor.context.style.bottom=this.editor.foot.offsetHeight,this.editor.source.style.bottom=this.editor.foot.offsetHeight}}]),l}(CommandBtn),TestWindow=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'loadContext',value:function loadContext(s){this.setContextHeight('100px'),this.setWidth('300px'),this.setLabWidth('80px');var m=document.createElement('div'),u=document.createElement('h4');u.innerText='\u5F00\u53D1\u8005\uFF1Ahhjjjh',m.appendChild(u);var p=document.createElement('span');p.innerText='\u535A\u5BA2:',m.appendChild(p);var f=document.createElement('a');f.href='https://blog.csdn.net/hhjjjh',f.innerText='https://blog.csdn.net/hhjjjh',m.appendChild(f),s.appendChild(m)}},{key:'setDefaultValue',value:function setDefaultValue(){}},{key:'click',value:function click(){return!0}}]),l}(BasicWindow),Test=function(t){function l(){return _classCallCheck(this,l),_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return _inherits(l,t),_createClass(l,[{key:'click',value:function click(){this.window=new TestWindow(this.editor,'test','\u5173\u4E8E'),this.window.show(!0);var u=new Api,p=u.getRange();console.log('\u9009\u4E2D\u533A\u57DF:'+p),console.log(p);var f;f=p.collapsed,console.log('\u5982\u679C\u8303\u56F4\u7684\u5F00\u59CB\u70B9\u548C\u7ED3\u675F\u70B9\u5728\u6587\u6863\u7684\u540C\u4E00\u4F4D\u7F6E:'+f),f=p.commonAncestorContainer,console.log('\u8303\u56F4\u7684\u5F00\u59CB\u70B9\u548C\u7ED3\u675F\u70B9\u7684\uFF08\u5373\u5B83\u4EEC\u7684\u7956\u5148\u8282\u70B9\uFF09:'+f),console.log(f),f=p.endContainer,console.log('\u5305\u542B\u8303\u56F4\u7684\u7ED3\u675F\u70B9\u7684 Document \u8282\u70B9:'+f),console.log(f),f=p.endOffset,console.log('endContainer \u4E2D\u7684\u7ED3\u675F\u70B9\u4F4D\u7F6E:'+f),f=p.startContainer,console.log('\u5305\u542B\u8303\u56F4\u7684\u5F00\u59CB\u70B9\u7684 Document \u8282\u70B9:'+f),console.log(f),f=p.startOffset,console.log('startContainer\u4E2D\u7684\u5F00\u59CB\u70B9\u4F4D\u7F6E:'+f);var y=p.toString();console.log('\u9009\u4E2D\u533A\u57DF\u7684\u6587\u5B57:'+y);var b=p.commonAncestorContainer;1!=b.nodeType&&(b=b.parentNode),console.log('\u9009\u4E2D\u533A\u57DF\u7684Element\u5143\u7D20:'+b),console.log(b);var C=p.cloneContents();console.log('\u9009\u4E2D\u533A\u57DF\u7684html:'+C),console.log(C);var k=!1;p.startContainer===p.endContainer&&p.startOffset===p.endOffset&&(k=!0),console.log('\u9009\u533A\u662F\u5426\u4E3A\u7A7A:'+k)}}]),l}(CommandBtn),Api=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:'bold',value:function bold(){var l=document.execCommand('bold',!1,null);return l}},{key:'italic',value:function italic(){var l=document.execCommand('italic',!1,null);return l}},{key:'underline',value:function underline(){var l=document.execCommand('underline',!1,null);return l}},{key:'strikeThrough',value:function strikeThrough(){var l=document.execCommand('strikeThrough',!1,null);return l}},{key:'superscript',value:function superscript(){var l=document.execCommand('superscript',!1,null);return l}},{key:'subscript',value:function subscript(){var l=document.execCommand('subscript',!1,null);return l}},{key:'backColor',value:function backColor(l){var s=document.execCommand('backColor',!1,l);return s}},{key:'fontName',value:function fontName(l){var s=document.execCommand('fontName',!1,l);return s}},{key:'fontSize',value:function fontSize(l){var s=document.execCommand('fontSize',!1,l);return s}},{key:'foreColor',value:function foreColor(l){var s=document.execCommand('foreColor',!1,l);return s}},{key:'indent',value:function indent(){var l=document.execCommand('indent',!1,null);return l}},{key:'outdent',value:function outdent(){var l=document.execCommand('outdent',!1,null);return l}},{key:'justifyFull',value:function justifyFull(){var l=document.execCommand('justifyFull',!1,null);return l}},{key:'justifyCenter',value:function justifyCenter(){var l=document.execCommand('justifyCenter',!1,null);return l}},{key:'justifyLeft',value:function justifyLeft(){var l=document.execCommand('justifyLeft',!1,null);return l}},{key:'justifyRight',value:function justifyRight(){var l=document.execCommand('justifyRight',!1,null);return l}},{key:'insertHTML',value:function insertHTML(l){var s=document.execCommand('insertHTML',!1,l);return s}},{key:'insertImage',value:function insertImage(l){var s=document.execCommand('insertImage',!1,l);return s}},{key:'createLink',value:function createLink(l){var s=document.execCommand('createLink',!1,l);return s}},{key:'unlink',value:function unlink(){var l=document.execCommand('unlink',!1,null);return l}},{key:'insertOrderedList',value:function insertOrderedList(){var l=document.execCommand('insertOrderedList',!1,null);return l}},{key:'insertUnorderedList',value:function insertUnorderedList(){var l=document.execCommand('insertUnorderedList',!1,null);return l}},{key:'removeFormat',value:function removeFormat(){var l=document.execCommand('removeFormat',!1,null);return l}},{key:'getSelection',value:function getSelection(){var l;return window.getSelection&&window.getSelection().getRangeAt?l=window.getSelection():document.selection&&document.selection.createRange&&(l=document.selection),l}},{key:'getRange',value:function getRange(){var l;return window.getSelection&&window.getSelection().getRangeAt?0<window.getSelection().rangeCount&&(l=this.getSelection().getRangeAt(0)):document.selection&&document.selection.createRange&&(l=this.getSelection().createRange()),l}},{key:'getElement',value:function getElement(l,s,m){return void 0==m&&null!=l&&(m=l.commonAncestorContainer,1!=m.nodeType&&(m=m.parentNode)),null!=m&&m.tagName!=s?(m=m.parentNode,null==m?null:this.getElement(l,s,m)):m}},{key:'seletTextBil',value:function seletTextBil(l,s,m,u){var p=this;if(null!=l){var f;if(void 0==u){this.removestatus=!1,this.status=!1;var y=l.cloneRange();this.spanstart=document.createElement('span'),this.spanstart.id='start',this.spanend=document.createElement('span'),this.spanend.id='end',l.insertNode(this.spanstart),y.collapse(!1),y.insertNode(this.spanend),l.setStartBefore(this.spanstart),l.setEndAfter(this.spanend),u=l.commonAncestorContainer,1!=u.nodeType&&(u=u.parentNode)}Array.from(u.childNodes).map(function(y){if(1==y.nodeType){if('start'==y.id?p.status=!0:'end'==y.id&&(p.status=!1,p.removestatus=!0),p.seletTextBil(l,s,m,y),void 0!=m&&m==y.nodeName){var b=s(y,p.status);void 0!=b&&(f=b)}}else if(void 0==m){var b=s(y,p.status);void 0!=b&&(f=b)}}),this.removestatus&&(null!=this.spanstart&&(l.setStartAfter(this.spanstart),this.spanstart.remove()),null!=this.spanend&&(l.setEndBefore(this.spanend),this.spanend.remove()),this.removestatus=!1),l.collapsed&&void 0!=f&&(l.setStartAfter(f),l.setEndBefore(f))}}},{key:'insertNodeAtCursor',value:function insertNodeAtCursor(l,s){var m;if(window.getSelection&&window.getSelection().getRangeAt){if(null!=l)return l.insertNode(s),!0;}else if(document.selection&&document.selection.createRange&&(m=3==s.nodeType?s.data:s.outerHTML,null!=l))return l.pasteHTML(m),!0;return!1}},{key:'insertHtmlAtCursor',value:function insertHtmlAtCursor(l,s){var m;if(window.getSelection&&window.getSelection().getRangeAt){if(null!=l)return m=l.createContextualFragment(s),l.insertNode(m),!0;}else if(document.selection&&document.selection.createRange&&null!=l)return l.pasteHTML(s),!0;return!1}},{key:'htmlFormat',value:function htmlFormat(l,s){var m='';if(s){var u=l.split('><'),f=0,y=0,b=!1,C='';Array.from(u).map(function(k){if(0<k.length){if(0<y){if(m+='>',C!=k.replace('/','').substring(0,0<k.search(' ')?k.search(' '):k.length)){m+='\n','/'===k.substring(0,1)?0<f&&f--:!1==b&&f++;for(var _=0;_<f;_++)m+='    '}m+='<'}m+=k,b=!!(0<=k.search('/')),C=k.replace('/','').substring(0,0<k.search(' ')?k.search(' '):k.length)}y++})}else{var u=l.split('>\n'),p=0;Array.from(u).map(function(f){m+=f.replace(/(^\s*)/g,''),p<u.length-1&&(m+='>'),p++})}return m}}]),t}();